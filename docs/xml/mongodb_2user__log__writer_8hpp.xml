<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="mongodb_2user__log__writer_8hpp" kind="file" language="C++">
    <compoundname>user_log_writer.hpp</compoundname>
    <includes refid="connection__thread__data_8hpp" local="yes">connection_thread_data.hpp</includes>
    <includes refid="tools_2message__logger_2mongodb_2types_8hpp" local="yes">types.hpp</includes>
    <includes refid="tools_2message__logger_2types_8hpp" local="yes">../types.hpp</includes>
    <includes local="yes">cstdmf/bgtask_manager.hpp</includes>
    <includes local="yes">mongo/client/dbclient.h</includes>
    <includedby refid="connection__thread__data_8hpp" local="yes">tools/message_logger/mongodb/connection_thread_data.hpp</includedby>
    <includedby refid="mongodb_2log__storage_8hpp" local="yes">tools/message_logger/mongodb/log_storage.hpp</includedby>
    <includedby refid="connection__thread__data_8cpp" local="yes">tools/message_logger/mongodb/connection_thread_data.cpp</includedby>
    <includedby refid="update__appid__task_8hpp" local="yes">tools/message_logger/mongodb/tasks/update_appid_task.hpp</includedby>
    <includedby refid="add__server__start__task_8cpp" local="yes">tools/message_logger/mongodb/tasks/add_server_start_task.cpp</includedby>
    <includedby refid="flush__task_8cpp" local="yes">tools/message_logger/mongodb/tasks/flush_task.cpp</includedby>
    <includedby refid="mongodb_2user__log__writer_8cpp" local="yes">tools/message_logger/mongodb/user_log_writer.cpp</includedby>
    <incdepgraph>
      <node id="21505">
        <label>list</label>
      </node>
      <node id="21503">
        <label>cstdmf/stdmf.hpp</label>
      </node>
      <node id="21500">
        <label>types.hpp</label>
        <link refid="tools_2message__logger_2mongodb_2types_8hpp_source"/>
        <childnode refid="21501" relation="include">
        </childnode>
        <childnode refid="21502" relation="include">
        </childnode>
        <childnode refid="21503" relation="include">
        </childnode>
        <childnode refid="21504" relation="include">
        </childnode>
        <childnode refid="21505" relation="include">
        </childnode>
        <childnode refid="21506" relation="include">
        </childnode>
        <childnode refid="21507" relation="include">
        </childnode>
      </node>
      <node id="21506">
        <label>string</label>
      </node>
      <node id="21512">
        <label>cstdmf/concurrency.hpp</label>
      </node>
      <node id="21513">
        <label>cstdmf/smartpointer.hpp</label>
      </node>
      <node id="21501">
        <label>cstdmf/bw_string.hpp</label>
      </node>
      <node id="21511">
        <label>cstdmf/bgtask_manager.hpp</label>
      </node>
      <node id="21496">
        <label>tools/message_logger/mongodb/user_log_writer.hpp</label>
        <link refid="mongodb/user_log_writer.hpp"/>
        <childnode refid="21497" relation="include">
        </childnode>
        <childnode refid="21500" relation="include">
        </childnode>
        <childnode refid="21508" relation="include">
        </childnode>
        <childnode refid="21511" relation="include">
        </childnode>
        <childnode refid="21504" relation="include">
        </childnode>
      </node>
      <node id="21504">
        <label>mongo/client/dbclient.h</label>
      </node>
      <node id="21497">
        <label>connection_thread_data.hpp</label>
        <link refid="connection__thread__data_8hpp_source"/>
        <childnode refid="21498" relation="include">
        </childnode>
        <childnode refid="21496" relation="include">
        </childnode>
        <childnode refid="21508" relation="include">
        </childnode>
        <childnode refid="21511" relation="include">
        </childnode>
        <childnode refid="21512" relation="include">
        </childnode>
        <childnode refid="21513" relation="include">
        </childnode>
        <childnode refid="21504" relation="include">
        </childnode>
      </node>
      <node id="21507">
        <label>vector</label>
      </node>
      <node id="21502">
        <label>cstdmf/bw_list.hpp</label>
      </node>
      <node id="21499">
        <label>constants.hpp</label>
        <link refid="mongodb_2constants_8hpp_source"/>
        <childnode refid="21500" relation="include">
        </childnode>
        <childnode refid="21501" relation="include">
        </childnode>
        <childnode refid="21503" relation="include">
        </childnode>
      </node>
      <node id="21509">
        <label>network/basictypes.hpp</label>
      </node>
      <node id="21508">
        <label>../types.hpp</label>
        <link refid="tools_2message__logger_2types_8hpp_source"/>
        <childnode refid="21509" relation="include">
        </childnode>
        <childnode refid="21501" relation="include">
        </childnode>
        <childnode refid="21510" relation="include">
        </childnode>
        <childnode refid="21503" relation="include">
        </childnode>
      </node>
      <node id="21510">
        <label>cstdmf/bw_vector.hpp</label>
      </node>
      <node id="21498">
        <label>connection_info.hpp</label>
        <link refid="connection__info_8hpp_source"/>
        <childnode refid="21499" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="21516">
        <label>tools/message_logger/mongodb/tasks/mongodb_background_task.hpp</label>
        <link refid="mongodb__background__task_8hpp_source"/>
        <childnode refid="21517" relation="include">
        </childnode>
        <childnode refid="21518" relation="include">
        </childnode>
        <childnode refid="21519" relation="include">
        </childnode>
        <childnode refid="21520" relation="include">
        </childnode>
        <childnode refid="21521" relation="include">
        </childnode>
        <childnode refid="21522" relation="include">
        </childnode>
        <childnode refid="21523" relation="include">
        </childnode>
        <childnode refid="21524" relation="include">
        </childnode>
      </node>
      <node id="21518">
        <label>tools/message_logger/mongodb/tasks/update_id_string_pair_task.hpp</label>
        <link refid="update__id__string__pair__task_8hpp_source"/>
      </node>
      <node id="21514">
        <label>tools/message_logger/mongodb/user_log_writer.hpp</label>
        <link refid="mongodb/user_log_writer.hpp"/>
        <childnode refid="21515" relation="include">
        </childnode>
        <childnode refid="21525" relation="include">
        </childnode>
        <childnode refid="21523" relation="include">
        </childnode>
      </node>
      <node id="21515">
        <label>tools/message_logger/mongodb/connection_thread_data.hpp</label>
        <link refid="connection__thread__data_8hpp_source"/>
        <childnode refid="21516" relation="include">
        </childnode>
        <childnode refid="21514" relation="include">
        </childnode>
        <childnode refid="21517" relation="include">
        </childnode>
        <childnode refid="21525" relation="include">
        </childnode>
        <childnode refid="21518" relation="include">
        </childnode>
        <childnode refid="21519" relation="include">
        </childnode>
        <childnode refid="21520" relation="include">
        </childnode>
        <childnode refid="21521" relation="include">
        </childnode>
        <childnode refid="21522" relation="include">
        </childnode>
        <childnode refid="21523" relation="include">
        </childnode>
        <childnode refid="21524" relation="include">
        </childnode>
      </node>
      <node id="21525">
        <label>tools/message_logger/mongodb/log_storage.hpp</label>
        <link refid="mongodb_2log__storage_8hpp_source"/>
      </node>
      <node id="21520">
        <label>tools/message_logger/mongodb/tasks/flush_task.hpp</label>
        <link refid="flush__task_8hpp_source"/>
      </node>
      <node id="21523">
        <label>tools/message_logger/mongodb/tasks/update_appid_task.hpp</label>
        <link refid="update__appid__task_8hpp_source"/>
      </node>
      <node id="21524">
        <label>tools/message_logger/mongodb/tasks/write_appid_task.hpp</label>
        <link refid="write__appid__task_8hpp_source"/>
      </node>
      <node id="21517">
        <label>tools/message_logger/mongodb/tasks/write_id_string_pair_task.hpp</label>
        <link refid="write__id__string__pair__task_8hpp_source"/>
      </node>
      <node id="21519">
        <label>tools/message_logger/mongodb/tasks/add_server_start_task.hpp</label>
        <link refid="add__server__start__task_8hpp_source"/>
      </node>
      <node id="21521">
        <label>tools/message_logger/mongodb/tasks/roll_task.hpp</label>
        <link refid="roll__task_8hpp_source"/>
      </node>
      <node id="21522">
        <label>tools/message_logger/mongodb/tasks/reconnect_task.hpp</label>
        <link refid="reconnect__task_8hpp_source"/>
      </node>
    </invincdepgraph>
    <innerclass refid="class_mongo_d_b_1_1_user_log_writer" prot="public">MongoDB::UserLogWriter</innerclass>
    <innernamespace refid="namespace_mongo_d_b">MongoDB</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>USER_LOG_WRITER_MONGODB_HPP</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>USER_LOG_WRITER_MONGODB_HPP</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;connection_thread_data.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;types.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../types.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;cstdmf/bgtask_manager.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;mongo/client/dbclient.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"><ref refid="namespace_b_w___b_e_g_i_n___n_a_m_e_s_p_a_c_e" kindref="compound">BW_BEGIN_NAMESPACE</ref></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespace_mongo_d_b" kindref="compound">MongoDB</ref></highlight></codeline>
<codeline lineno="17"><highlight class="normal">{</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">ConnectionThreadData;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22" refid="class_mongo_d_b_1_1_user_log_writer" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="class_mongo_d_b_1_1_user_log_writer" kindref="compound">UserLogWriter</ref><sp/>:<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>SafeReferenceCount</highlight></codeline>
<codeline lineno="23"><highlight class="normal">{</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_mongo_d_b_1_1_user_log_writer_1a7d569029f411706157868bc0e9d53d53" kindref="member">UserLogWriter</ref>(<sp/><ref refid="class_mongo_d_b_1_1_connection_thread_data" kindref="compound">ConnectionThreadData</ref><sp/>&amp;<sp/>connectionData,</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MessageLogger::UID<sp/>uid,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>BW::string<sp/>&amp;<sp/>userName,</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>BW::string<sp/>&amp;<sp/>loggerID_<sp/>);</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_mongo_d_b_1_1_user_log_writer_1a0b694deb9c0341730778917f2c57c3cb" kindref="member">initDB</ref>();</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_mongo_d_b_1_1_user_log_writer_1af871d3da22bf7529f7e62f235254713b" kindref="member">flush</ref>(<sp/>BSONObjBuffer<sp/>&amp;<sp/>logBuffer<sp/>);</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_mongo_d_b_1_1_user_log_writer_1a0f557c700055744c132546696d97326e" kindref="member">writeComponent</ref>(<sp/>mongo::BSONObj<sp/>&amp;<sp/>obj<sp/>);</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_mongo_d_b_1_1_user_log_writer_1a25ce6a46cdd8769fc08901862629c672" kindref="member">onServerStart</ref>(<sp/>uint64<sp/>timestamp<sp/>);</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_mongo_d_b_1_1_user_log_writer_1ae68331cbe21b0693371a3643829bd950" kindref="member">rollAndPurge</ref>(<sp/>uint64<sp/>seconds<sp/>);</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_mongo_d_b_1_1_user_log_writer_1ad865c109696a906aa57f2a42d204012f" kindref="member">purgeExpiredColls</ref>(<sp/>uint64<sp/>seconds<sp/>);</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>BW::string<sp/>&amp;<sp/>getUserName()<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>userName_;<sp/>};</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>BW::string<sp/>&amp;<sp/>getUserDBName()<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dbName_;<sp/>};</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>initUIDCollection();</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>initServerStartsColl();</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>initComponentsColl();</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>shardDatabase();</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>initActiveColl();</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>createLogIndex(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>BW::string<sp/>&amp;<sp/>logCollNamespace<sp/>);</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>BW::string<sp/>getNewCollName();</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>BW::string<sp/>getTimeStampSuffix();</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>getCollList(<sp/>CollList<sp/>&amp;<sp/>collList<sp/>);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>isCollectionExpired(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>BW::string<sp/>&amp;<sp/>collNS,</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>BW::string<sp/>&amp;<sp/>timeSuffix,<sp/>uint64<sp/>seconds<sp/>);</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>dropCollection(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>BW::string<sp/>&amp;<sp/>collNS<sp/>);</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_mongo_d_b_1_1_connection_thread_data" kindref="compound">ConnectionThreadData</ref><sp/>&amp;<sp/>connectionData_;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>MessageLogger::UID<sp/>uid_;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>BW::string<sp/>userName_;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>BW::string<sp/>dbName_;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>BW::string<sp/>activeCollName_;</highlight></codeline>
<codeline lineno="61"><highlight class="normal">};</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>MongoDB</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal">BW_END_NAMESPACE</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
    </programlisting>
    <location file="tools/message_logger/mongodb/user_log_writer.hpp"/>
  </compounddef>
</doxygen>
